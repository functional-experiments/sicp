
-- Exercise 1.9.
-- Each of the following two procedures defines a method for adding two
-- positive integers in terms of the procedures inc, which increments its
-- argument by 1, and dec, which decrements its argument by 1.
--
-- (define (+ a b)
--   (if (= a 0)
--       b
--       (inc (+ (dec a) b))))
--
-- (define (+ a b)
--   (if (= a 0)
--       b
--       (+ (dec a) (inc b))))
-- 
-- Using the substitution model, illustrate the process generated by each
-- procedure in evaluating (+ 4 5). Are these processes iterative or recursive? 

inc1 :: Int -> Int
inc1 a = a + 1

dec1 :: Int -> Int
dec1 a = a - 1

plus1 :: Int -> Int -> Int
plus1 a b = res where
    res | (==) a 0 = b
        | otherwise = inc1 (plus1 (dec1 a) b)

plus2 :: Int -> Int -> Int
plus2 a b = res where
    res | (==) a 0 = b
        | otherwise = plus2 (dec1 a) (inc1 b)


main :: IO ()
main = do
    print "plus1 is linear recursive"
    print "(+ 4 5)"
    print "(inc (+ 3 5))"
    print "(inc (inc (+ 2 5)))"
    print "(inc (inc (inc (+ 1 5))))"
    print "(inc (inc (inc (inc (+ 0 5)))))"
    print "(inc (inc (inc (inc 5))))"
    print "(inc (inc (inc 6)))"
    print "(inc (inc 7))"
    print "(inc 8)"
    print "9"
    print $ plus1 4 5

    putStrLn ""
    print "plus2 is linear iterative"
    print "(+ 4 5)"
    print "(+ 3 6)"
    print "(+ 2 7)"
    print "(+ 1 8)"
    print "(+ 0 9)"
    print "9"
    print $ plus2 4 5
