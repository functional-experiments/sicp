
-- Exercise 1.14.
--
-- Draw the tree illustrating the process generated by the count-change
-- procedure of section 1.2.2 in making change for 11 cents.
-- What are the orders of growth of the space and number of steps
-- used by this process as the amount to be changed increases? 


-- (define (first-denomination kinds-of-coins)
--  (cond ((= kinds-of-coins 1) 1)
--        ((= kinds-of-coins 2) 5)
--        ((= kinds-of-coins 3) 10)
--        ((= kinds-of-coins 4) 25)
--        ((= kinds-of-coins 5) 50)))
firstDenomination :: Int -> Int
firstDenomination 1 = 1
firstDenomination 2 = 5
firstDenomination 3 = 10
firstDenomination 4 = 25
firstDenomination 5 = 50

-- (define (cc amount kinds-of-coins)
--  (cond ((= amount 0) 1)
--        ((or (< amount 0) (= kinds-of-coins 0)) 0)
--        (else (+ (cc amount
--                     (- kinds-of-coins 1))
--                 (cc (- amount
--                        (first-denomination kinds-of-coins))
--                     kinds-of-coins)))))
cc :: Int -> Int -> Int
cc amount kindsOfCoins
    | 0 == amount = 1
    | amount < 0 || 0 == kindsOfCoins = 0
    | otherwise =
        (cc amount (kindsOfCoins - 1)) +
        (cc (amount - (firstDenomination kindsOfCoins)) kindsOfCoins)

countChange :: Int -> Int
countChange amount = cc amount 5


main :: IO ()
main = do
    print $ "countChange 11"
    print $ "cc 11 5"
    print $ "|- cc 11 4"
    print $ "||- cc 11 3"
    print $ "|||- cc 11 2"
    print $ "||||- cc 11 1"
    print $ "|||||- cc 11 0"
    print $ "|||||- cc 10 1"
    print $ "||||||- cc 10 0"
    print $ "||||||- cc 9 1"
    print $ "|||||||- cc 9 0"
    print $ "|||||||- cc 8 1"
    print $ "||||||||- cc 8 0"
    print $ "||||||||- cc 7 1"
    print $ "|||||||||- cc 7 0"
    print $ "|||||||||- cc 6 1"
    print $ "||||||||||- cc 6 0"
    print $ "||||||||||- cc 5 1"
    print $ "|||||||||||- cc 5 0"
    print $ "|||||||||||- cc 4 1"
    print $ "||||||||||||- cc 4 0"
    print $ "||||||||||||- cc 3 1"
    print $ "|||||||||||||- cc 3 0"
    print $ "|||||||||||||- cc 2 1"
    print $ "||||||||||||||- cc 2 0"
    print $ "||||||||||||||- cc 1 1"
    print $ "|||||||||||||||- cc 1 0"
    print $ "|||||||||||||||- cc 0 1 (*)"
    print $ "||||- cc 6 2"
    print $ "|||||- cc 6 1"
    print $ "||||||- cc 6 0"
    print $ "||||||- cc 5 1"
    print $ "|||||||- cc 5 0"
    print $ "|||||||- cc 4 1"
    print $ "||||||||- cc 4 0"
    print $ "||||||||- cc 3 1"
    print $ "|||||||||- cc 3 0"
    print $ "|||||||||- cc 2 1"
    print $ "||||||||||- cc 2 0"
    print $ "||||||||||- cc 1 1"
    print $ "|||||||||||- cc 1 0"
    print $ "|||||||||||- cc 0 1 (*)"
    print $ "|||||- cc 1 2"
    print $ "||||||- cc 1 1"
    print $ "|||||||- cc 1 0"
    print $ "|||||||- cc 0 1 (*)"
    print $ "||||||- cc -4 2"
    print $ "|||- cc 1 3"
    print $ "||||- cc 1 2"
    print $ "|||||- cc 1 1"
    print $ "||||||- cc 1 0"
    print $ "||||||- cc 0 1 (*)"
    print $ "|||||- cc -4 2"
    print $ "||||- cc -9 3"
    print $ "||- cc -14 4"
    print $ "|- cc -39 5"
    print $ countChange 11
    print $ countChange 100
